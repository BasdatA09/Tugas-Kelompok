/*
******************
*  Membuat Tabel *
*      Dosen     *
******************
*/
CREATE TABLE DOSEN
(
NIP VARCHAR(20) PRIMARY KEY
, nama VARCHAR(100) NOT NULL
, username VARCHAR(50) NOT NULL
, password VARCHAR(50) NOT NULL
, email VARCHAR(100) NOT NULL
, institusi VARCHAR(100) NOT NULL
);

/*
******************
*  Insert Manual ke
*   Tabel Dosen
******************
*/

INSERT INTO DOSEN VALUES (1208050382,'Wisnu Jatmiko','wisnuj','E=hnX9\d','wisnuj@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (030603001,'Belawati H. Widjaja','bela','uMR7pq:<','bela@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (196111251992031001,'T. Basaruddin','chan','(5dR^7$''','chan@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (129903001,'Ade Azurat','ade','fe4\HAl/','ade@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (121203009,'Hanif Rasyidi','hanifr','4Q3''MkQ-','hanifr@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (128922033,'Muhammad Anwar Ma''sum','muhammad.anwar','Nw.rO4p9','muhammad_anwar@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (196604261997021001,'Bob Hardian','hardian','9(B8NtN;','hardian@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (198704262012121002,'Bayu Distiawan Trisedya','b.distiawan','$3@Syd=*','b.distiawan@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (196110221995031001,'Dana Indra Sensuse','dana','33$fK&a4','dana@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (197705022000122001,'Dina  Chahyati','dina','r47T6-=E','dina@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (195906171985032002,'Erdefi Rakun','efi','2x+4J5jZ','efi@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (196105101987032001,'Kasiyah M. Junus','kasiyah','Y&Yr9tBY','kasiyah@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (197603012008121001,'Indra Budi','indra','5Q*w?aFn','indra@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (120803003,'Harry Budi Santoso','harrybs','!Bd7J8Hv','harrybs@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (121103004,'Puspa Indahati Sandhyaduhita','p.indahati','tK8SkV^#','p.indahati@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (197801212008122001,'Siti Aminah','aminah','L8ngQ*v7','aminah@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (197609262010121001,'Ari Saptawijaya','saptawijaya','a4vVt!r!','saptawijaya@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (196706252000031002,' Petrus Mursanto','santo','xH9!HvvP','santo@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (197512202009122003,'Ika Alfina','ika.alfina','UW@m2pQM','ika.alfina@cs.ui.ac.id','Universutas Indonesia');
INSERT INTO DOSEN VALUES (197209201998022001,'Yova Ruldeviyani','yova','*6a-AY\A','yova@cs.ui.ac.id','Universutas Indonesia');

/*
******************
*  Insert Otomatis ke
*   Tabel Dosen secara random
******************
*/
CREATE OR REPLACE FUNCTION dosen_auto_generate()
 RETURNS void AS
$$

DECLARE
    COUNTER INTEGER := 0;
    NIP TEXT := '12345678';
    NAME TEXT := 'Dosen Fasilkom';
    USERNAME TEXT := 'dosenbasdat';
    PASSWORD TEXT := 'lulusinbasdat';
    EMAIL TEXT := 'basdathebat';
    INSTITUSI TEXT := 'Universitas Indonesia';
BEGIN
 LOOP
    EXIT WHEN COUNTER = 30;
    COUNTER := COUNTER + 1;

    INSERT INTO  DOSEN (NIP, NAMA, USERNAME, PASSWORD, EMAIL , INSTITUSI)
        VALUES (COUNTER || NIP, NAME || COUNTER, USERNAME || COUNTER, PASSWORD || COUNTER, EMAIL || COUNTER || '@ui.ac.id',INSTITUSI);
 END LOOP;
END;
$$
LANGUAGE 'plpgsql';

/*
******************
*  Membuat Tabel
*  DOSEN_PEMBIMBING
******************
*/

CREATE TABLE DOSEN_PEMBIMBING
(
IDMKS INT NOT NULL REFERENCES MKS(IdMKS) ON UPDATE CASCADE ON DELETE RESTRICT,
NIPdosenpembimbing  VARCHAR(20) NOT NULL REFERENCES DOSEN(NIP) ON UPDATE CASCADE ON DELETE RESTRICT,
PRIMARY KEY(IDMKS , NIPdosenpembimbing)
);

/*
******************
*  Insert Manual ke
*   Tabel Dosen_Pembimbing
******************
*/

INSERT INTO DOSEN_PEMBIMBING VALUES (2,1208050382);
INSERT INTO DOSEN_PEMBIMBING VALUES (6,030603001);
INSERT INTO DOSEN_PEMBIMBING VALUES (8,196111251992031001);
INSERT INTO DOSEN_PEMBIMBING VALUES (10,129903001);
INSERT INTO DOSEN_PEMBIMBING VALUES (12,121203009);
INSERT INTO DOSEN_PEMBIMBING VALUES (14,128922033);
INSERT INTO DOSEN_PEMBIMBING VALUES (4,196604261997021001);
INSERT INTO DOSEN_PEMBIMBING VALUES (15,198704262012121002);
INSERT INTO DOSEN_PEMBIMBING VALUES (16,196110221995031001);
INSERT INTO DOSEN_PEMBIMBING VALUES (17,197705022000122001);
INSERT INTO DOSEN_PEMBIMBING VALUES (18,195906171985032002);
INSERT INTO DOSEN_PEMBIMBING VALUES (19,196105101987032001);
INSERT INTO DOSEN_PEMBIMBING VALUES (20,197603012008121001);
INSERT INTO DOSEN_PEMBIMBING VALUES (21,120803003);
INSERT INTO DOSEN_PEMBIMBING VALUES (22,121103004);
INSERT INTO DOSEN_PEMBIMBING VALUES (23,197801212008122001);
INSERT INTO DOSEN_PEMBIMBING VALUES (24,197609262010121001);
INSERT INTO DOSEN_PEMBIMBING VALUES (25,196706252000031002);
INSERT INTO DOSEN_PEMBIMBING VALUES (28,197512202009122003);
INSERT INTO DOSEN_PEMBIMBING VALUES (27,197209201998022001);
INSERT INTO DOSEN_PEMBIMBING VALUES (29,1208050382);
INSERT INTO DOSEN_PEMBIMBING VALUES (30,030603001);
INSERT INTO DOSEN_PEMBIMBING VALUES (31,196111251992031001);
INSERT INTO DOSEN_PEMBIMBING VALUES (32,129903001);
INSERT INTO DOSEN_PEMBIMBING VALUES (33,121203009);
INSERT INTO DOSEN_PEMBIMBING VALUES (34,128922033);
INSERT INTO DOSEN_PEMBIMBING VALUES (35,196604261997021001);
INSERT INTO DOSEN_PEMBIMBING VALUES (36,198704262012121002);
INSERT INTO DOSEN_PEMBIMBING VALUES (37,196110221995031001);
INSERT INTO DOSEN_PEMBIMBING VALUES (38,197705022000122001);
INSERT INTO DOSEN_PEMBIMBING VALUES (39,195906171985032002);
INSERT INTO DOSEN_PEMBIMBING VALUES (40,196105101987032001);
INSERT INTO DOSEN_PEMBIMBING VALUES (41,197603012008121001);
INSERT INTO DOSEN_PEMBIMBING VALUES (42,120803003);
INSERT INTO DOSEN_PEMBIMBING VALUES (43,121103004);
INSERT INTO DOSEN_PEMBIMBING VALUES (44,197801212008122001);
INSERT INTO DOSEN_PEMBIMBING VALUES (45,197609262010121001);
INSERT INTO DOSEN_PEMBIMBING VALUES (46,196706252000031002);
INSERT INTO DOSEN_PEMBIMBING VALUES (47,197512202009122003);
INSERT INTO DOSEN_PEMBIMBING VALUES (48,197209201998022001);

/*
******************
*  Insert Otomatis
*   Ke tabel Dosen_Pembimbing
*   bisa terjadi konflik , karena ini random ada kemungkinan data yang dimasukkan sama dengan insert manual
******************
*/

INSERT INTO DOSEN_PEMBIMBING(IDMKS , NIPdosenpembimbing) SELECT m.idmks , d.nip from mks m cross join dosen d order by RANDOM() limit 60;

/*
******************
*  Membuat Tabel
*  SARAN_DOSEN_PENGUJI
******************
*/

CREATE TABLE SARAN_DOSEN_PENGUJI
(
IDMKS INT NOT NULL REFERENCES MKS(IdMKS) ON UPDATE CASCADE ON DELETE RESTRICT,
NIPsaranpenguji VARCHAR(20) NOT NULL REFERENCES DOSEN(NIP) ON UPDATE CASCADE ON DELETE RESTRICT,
PRIMARY KEY(IDMKS , NIPsaranpenguji)
);

INSERT INTO SARAN_DOSEN_PENGUJI VALUES (1,1208050382);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (2,030603001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (3,196111251992031001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (3,129903001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (4,196111251992031001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (4,128922033);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (5,196111251992031001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (5,196604261997021001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (6,196111251992031001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (6,196604261997021001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (7,196604261997021001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (7,198704262012121002);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (8,196604261997021001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (8,196110221995031001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (9,196604261997021001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (9,197705022000122001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (10,196604261997021001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (10,195906171985032002);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (10,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (11,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (11,197603012008121001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (12,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (12,120803003);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (13,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (13,121103004);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (14,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (14,197801212008122001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (15,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (15,197609262010121001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (16,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (16,196706252000031002);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (17,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (17,197512202009122003);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (18,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (19,197209201998022001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (19,1208050382);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (20,030603001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (21,030603001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (21,196111251992031001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (22,121203009);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (22,128922033);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (23,030603001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (24,196604261997021001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (25,198704262012121002);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (26,196110221995031001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (27,197705022000122001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (28,195906171985032002);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (29,196105101987032001);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (30,121103004);
INSERT INTO SARAN_DOSEN_PENGUJI VALUES (30,196105101987032001);



/*
******************
*  Insert Otomatis
*   Ke tabel SARAN_DOSEN_PENGUJI
*   bisa terjadi konflik , karena ini random ada kemungkinan data yang dimasukkan sama dengan insert manual
******************
*/
INSERT INTO SARAN_DOSEN_PENGUJI(IDMKS , NIPsaranpenguji) SELECT m.idmks , d.nip from mks m cross join dosen d order by RANDOM() limit 50;

/*
******************
*  Membuat Tabel
*  DOSEN_PENGUJI
******************
*/
CREATE TABLE DOSEN_PENGUJI
(
IDMKS INT NOT NULL REFERENCES MKS(IdMKS) ON UPDATE CASCADE ON DELETE RESTRICT,
NIPdosenpenguji VARCHAR(20) NOT NULL  REFERENCES DOSEN(NIP) ON UPDATE CASCADE ON DELETE RESTRICT,
PRIMARY KEY(IDMKS , NIPdosenpenguji)
);


INSERT INTO DOSEN_PENGUJI VALUES (1,1208050382);
INSERT INTO DOSEN_PENGUJI VALUES (2,030603001);
INSERT INTO DOSEN_PENGUJI VALUES (3,196111251992031001);
INSERT INTO DOSEN_PENGUJI VALUES (4,196111251992031001);
INSERT INTO DOSEN_PENGUJI VALUES (5,196111251992031001);
INSERT INTO DOSEN_PENGUJI VALUES (6,196604261997021001);
INSERT INTO DOSEN_PENGUJI VALUES (7,196604261997021001);
INSERT INTO DOSEN_PENGUJI VALUES (8,196604261997021001);
INSERT INTO DOSEN_PENGUJI VALUES (9,197705022000122001);
INSERT INTO DOSEN_PENGUJI VALUES (10,195906171985032002);
INSERT INTO DOSEN_PENGUJI VALUES (11,196105101987032001);
INSERT INTO DOSEN_PENGUJI VALUES (12,196105101987032001);
INSERT INTO DOSEN_PENGUJI VALUES (13,196105101987032001);
INSERT INTO DOSEN_PENGUJI VALUES (14,196105101987032001);
INSERT INTO DOSEN_PENGUJI VALUES (15,197609262010121001);
INSERT INTO DOSEN_PENGUJI VALUES (16,196706252000031002);
INSERT INTO DOSEN_PENGUJI VALUES (17,197512202009122003);
INSERT INTO DOSEN_PENGUJI VALUES (18,196105101987032001);
INSERT INTO DOSEN_PENGUJI VALUES (19,197209201998022001);
INSERT INTO DOSEN_PENGUJI VALUES (20,1208050382);
INSERT INTO DOSEN_PENGUJI VALUES (21,030603001);
INSERT INTO DOSEN_PENGUJI VALUES (22,196111251992031001);
INSERT INTO DOSEN_PENGUJI VALUES (23,121203009);
INSERT INTO DOSEN_PENGUJI VALUES (24,030603001);
INSERT INTO DOSEN_PENGUJI VALUES (25,196604261997021001);
INSERT INTO DOSEN_PENGUJI VALUES (26,198704262012121002);
INSERT INTO DOSEN_PENGUJI VALUES (27,196110221995031001);
INSERT INTO DOSEN_PENGUJI VALUES (28,197705022000122001);
INSERT INTO DOSEN_PENGUJI VALUES (29,195906171985032002);
INSERT INTO DOSEN_PENGUJI VALUES (30,196105101987032001);
INSERT INTO DOSEN_PENGUJI VALUES (31,121103004);
INSERT INTO DOSEN_PENGUJI VALUES (32,196111251992031001);
INSERT INTO DOSEN_PENGUJI VALUES (33,129903001);
INSERT INTO DOSEN_PENGUJI VALUES (34,121203009);
INSERT INTO DOSEN_PENGUJI VALUES (35,128922033);
INSERT INTO DOSEN_PENGUJI VALUES (36,196604261997021001);
INSERT INTO DOSEN_PENGUJI VALUES (37,198704262012121002);
INSERT INTO DOSEN_PENGUJI VALUES (38,196110221995031001);
INSERT INTO DOSEN_PENGUJI VALUES (39,197705022000122001);
INSERT INTO DOSEN_PENGUJI VALUES (40,195906171985032002);


/*
******************
*  Insert Otomatis
*   Ke tabel DOSEN_PENGUJI
*   bisa terjadi konflik , karena ini random ada kemungkinan data yang dimasukkan sama dengan insert manual
******************
*/
INSERT INTO DOSEN_PENGUJI(IDMKS , NIPdosenpenguji) SELECT m.idmks , d.nip from mks m cross join dosen d order by RANDOM() limit 60;


